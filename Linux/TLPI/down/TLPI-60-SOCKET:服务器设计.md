# intro
- 本章讨论了设计 `迭代型` 和 `并发型` **服务器端程序** 的基础
- 本章也描述了 inetd: 一个特殊的`守护进程`，使得创建网络服务变得更加便捷

# 60-1 迭代型和并发型服务器
使用socket的网络服务器端程序,有两种常见的设计方式:
- 迭代型:
    - 服务器每次只处理一个客户端，只有当完全处理完一个客户端的请求后才去处理下一个客户端
    - 迭代型服务器的典型应用场景是当客户端和服务器之间交换单个请求和响应时
- 并发型:
    - 能够同时处理多个客户端的请求
    - 用于对每个请求都需要大量处理时间，或者是当客户端和服务器在进行扩展对话中需要来回传递消息的场景

# 60.2 迭代型 UDP echo 服务器
- echo服务支持 UDP TCP,工作在端口7上
- UDP echo 服务器连续读取数据报，将每个数据报的拷贝返回给发送者。由于服务器一次只需处理一条单独的消息，因此设计为迭代型服务器就足够了

# 60.3 并发性TCP echo 服务器
- TCP echo工作在端口7
- TCP echo 服务器接受一条连接然后不断循环，读取所有已传输的数据并在同一个套接字上将它们发回给客户端。服务器不断读取数据直到它检测到文件结尾为止，此时服务器就关闭它的套接字
- 每次调用 fork()后， 监听套接字和连接套接字都在子进程中得到复制:这意味着父子进程都可以通过连接套接字和客户端通信
- 但是，只有子进程才需要进行这样的通信， 因此父进程应该在 fork()调用之后立刻关闭连接套接字的文件描述符
- 子进程在处理完一个客户端后终止

# 60.4 并发性服务器的其他设计方案
- 针对高负载服务器设计:例如web服务器(每秒上万并发)

- 在服务器上预先创建线程或进程
    - 线程池
    - 进程池

- 在单个进程中处理多个客户端(允许单个进程同时监视多个文件描述符上 I/O 事件的 I/O 模型)
    - I/O多路复用
    - 信号驱动I/O
    - epoll

- 采用服务器集群
    - DNS 循环轮转 / DNS round-robin load sharing

# 60.5 inetd(internet 超级服务器) 守护进程
- 守护进程 inetd 被设计为用来消除运行大量 `非常用服务器进程` 的需要
    - 可降低系统上运行的进程数量:不用为每个服务单独运行一个守护进程,只需一个inetd就可以监视一组指定的套接字
    - inetd 简化了启动其他服务的编程工作

- Internet 超级服务器守护进程 inetd 可以监视多个套接字， 并启动合适的服务器进程作为到来的 UDP 数据报或 TCP 连接的响应
- 可以将运行在系统上的网络服务进程的数量降到最小，降低系统的整体负载
- 可以简化服务器端的编程工作: 服务器进程初始化阶段所需要的大部分操作 inetd 都可以帮我们完成