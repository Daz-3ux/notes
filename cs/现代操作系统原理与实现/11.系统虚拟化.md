# 11.1 系统虚拟化技术概述

## 11.1.1 系统虚拟化及其组成部分
- 系统虚拟化技术能够在一台物理主机上创建多个`虚拟机`
  - 技术核心为`虚拟机监控器`
  - 虚拟化监控机运行在CPU的最高特权级,直接控制着硬件,并为上层软件提供虚拟的硬件接口,让其以为自己运行在真实的物理主机上

- 系统虚拟化技术主要包含三方面
  - `CPU虚拟化`
    - 为虚拟机提供`虚拟处理器(vCPU)`的抽象并执行其指令的过程
    - 虚拟机监控器直接运行在物理主机上,使用物理 ISA,并向上层虚拟机提供虚拟 ISA
    - 虚拟 ISA 可以与物理 ISA 相同,也可以完全不同
  - `内存虚拟化`
    - 虚拟机监控器负责管理所有物理内存
    - 引入一层新的地址空间:`客户物理地址`
    - 提供新的翻译机制,将虚拟机中`假`的物理地址翻译成`真`的物理地址
  - `I/O虚拟化`
    - 虚拟机监控器负责提供虚拟的 I/O 设备支持
    - 将所有对虚拟设备的访问映射为对物理设备的访问

## 11.1.2 虚拟机监控器的类型
- Type1: 虚拟机直接运行在最高特权级,就像一个操作系统
- Type2: 依托于宿主操作系统,比如QEMU
![](https://i.imgur.com/AT5zKyM.png)

# 11.2 CPU虚拟化

## 11.2.1 下陷和模拟

## 11.2.2 可虚拟化结构与不可虚拟化结构

## 11.2.3 解释执行

## 11.2.4 动态二进制翻译

## 11.2.5 扫描和翻译

## 11.2.6 半虚拟化机制

## 11.2.7 硬件虚拟化技术

## 11.2.8 小结

# 11.3 内存虚拟化

## 11.3.1 影子页表机制

## 11.3.2 影子页表的缺页异常处理流程

## 11.3.3 直接页表映射机制

## 11.3.4 两阶段地址翻译机制

## 11.3.5 换页和内存气球机制

## 11.3.6 小结

# # 11.4 I/O 虚拟化

## 11.4.1 软件模拟方法

## 11.4.2 半虚拟化技术

## 11.4.3 设备直通

## 11.4.4 小结

# # 11.5 中断虚拟化
